\chapter{One Dimensional Stochastic Case}\label{chap:one-d-stochastic}

Here we return to the one dimensional version of this equation, but this time
we introduce some form of uncertainty in the coefficients of the equation:

\begin{equation}\label{eq:oned-stochastic}
  \begin{aligned}
      -\frac{d}{dx}\left[\kappa(x;\omega)\frac{d}{dx}u(x;\omega)\right] &= f(x)\,
                              &x \in  D = [-1,1]\, \omega \in \Omega \\
    u(x;\omega) &= 0 &x \in \partial D = \{-1,1\}\, \omega \in \Omega
  \end{aligned}
\end{equation}

where $\Omega$ is a probability space. In order to handle this case, we follow
a similar method to that we used in Chapter \ref{chap:oned-deterministic}
however with the introduction of the random parameter $\omega$ there is an
additional layer of complexity to deal with, as well as discretising the
physical domain we also need to be able to discretise the probability space
using a finite dimensional approximation.  This is where the generalised
polynomial chaos comes in.

Using the methodology outlined in \cite{general-poly-chaos} we can use various
polynomials in the \textit{Askey Scheme} to construct a finite dimensional
approximate representations of various random processes which when used in
conjunction with the Finite Element Method we can model the expected behaviour
of the solution process $u(x;\omega)$

\section{Weak Formulation}

\todo[inline]{Make exact all the functional spaces etc.}

As with the deterministic cases, we first need to obtain the weak formulation
of the problem, where we multiply through by $w \in W$ and integrate over the
domain.

\begin{equation}
    -\int_{\Omega}\int_{-1}^1\left(\frac{d}{dx}\left[\kappa(x;\omega)\frac{d}{dx}u(x;\omega)\right]
    w(x;\omega)\right)\, dx\, d\Omega = \int_{\Omega}\int_{-1}^1 f(x)w(x;\omega)\, dx\, d\Omega
\end{equation}

Proceeding with integration by parts

\begin{equation}
    -\int_{\Omega}\left(
      \underbrace{\left[\kappa(x;\omega)\frac{d}{dx}u(x;\omega)
                        w(x;\omega)\right]_{-1}^1}_{= 0}
       -\int_{-1}^1\kappa(x;\omega)\frac{d}{dx}u(x;\omega)\frac{d}{dx}w(x;\omega)\, dx
    \right)\, d\Omega = \int_{\Omega}\int_{-1}^1 f(x)w(x;\omega)\, dx\, d\Omega
\end{equation}

where the underbraced term is zero as the elements of $W$ are zero at the
endpoints of the domain. Hence the weak form of this equation is given by:

\begin{equation}\label{eq:wk-two-d-stochastic}
    \int_{\Omega}\int_{-1}^1\kappa(x;\omega)
           \frac{d}{dx}u(x;\omega)\frac{d}{dx}w(x;\omega)\, dx\, d\Omega =
           \int_{\Omega}\int_{-1}^1 f(x)w(x;\omega)\, dx\, d\Omega
\end{equation}

where finding a solution in this sense would be to find a $u \in V$ such that
the above is satisfied $\forall w \in W$

\section{Discrete Formulation}

In order to find a

\subsection{KL-Expansion}

The Karhunen-Loeve (KL) expansion allows us to write any second order
stochastic process $X(\v{x},\omega)$ in the following way:

\begin{equation}
    X(\v{x}, \omega) = \bar{X}(\v{x})
    + \sum_{n = 0}^\infty\sqrt{\lambda_n}\beta_n(\v{x})\xi_n(\omega)
\end{equation}

where:

\begin{itemize}
    \item $\bar{X}(\v{x})$ denotes the expected value of the process
    \item $\{\xi_n(\omega)\}_{n=0}^\infty$ forms a set of uncorrelated random
          variables
    \item $\lambda_n$, $\beta_n(\v{x})$ denote the eigenvalues/eigenfunctions
          of the following eigenvalue problem:
          \[
                \int_DC(\v{x}_1, \v{x}_2)\beta(\v{x})\, d\v{x}_1
                = \lambda\beta(\v{x}_2)
          \]
          where $C(\v{x}_1,\v{x}_2)$ denotes the correlation function of the
          random process.
\end{itemize}

The derivation of this representation is discussed in \cite{stochastic-fem} as
well as a number of its properties. One such property is that this
representation is optimal in the sense that when we truncate the series to a
finite number of terms the mean squared error is minimised.

Of course since this representation requires that we know the correlation
function of the random process we will only be able to apply this to the terms
that we know a priori in the equation.

Since the weak formulation \myref{eq:wk-two-d-stochastic} has to be satisifed
$\forall w \in W$ it must in particular hold for the basis functions. So by
choosing $w = \sum_{t=1}^P\sum_{j=1}^N\phi_j(x)\chi_t(x)$ and using the
exapansions

\begin{align}
    u^h(x;\omega) &= \sum_{s=1}^P\sum_{r=1}^Nu_{r,s}\phi_r(x)\chi_s(\omega) \\
    \kappa(x;\omega) &\approx \mu + \sigma\sum_{l=1}^d\sqrt{\lambda_l}\beta_l(x)\xi_l(\omega)
\end{align}

and substituting them into the weak formulation then we get for each $j \in
\{1,\ldots,N\}$ and each $t \in \{1,\ldots,P\}$ we get:

\begin{align*}
    \int_{\Omega}\int_{-1}^1
      \left(\mu + \sum_{l=1}^d\sqrt{\lambda_l}\beta_l(x)\xi_l(\omega)\right)
      \frac{d}{dx}\left(\sum_{s=1}^P\sum_{i=1}^Nu_{s,i}\phi_i(x)\chi(\omega)\right)
      \phi_j'(x)\chi_t(\omega)\, dx\, d\Omega \\ =
    \int_{\Omega}\int_{-1}^1
      \left(\sum_{i=1}^Nf_i\phi_i(x)\right)
      \phi_j(x)\chi_t(\omega)\, dx\, d\Omega
\end{align*}

Then by the linearity of the integral and differential operator we may write
this as:

\begin{align*}
    \mu\sum_{s=1}^P\sum_{i=1}^Nu_{s,i}&\int_\Omega\int_{-1}^1
      \phi_i'(x)\phi_j'(x)\chi_s(\omega)\chi_t(\omega)\, dx\, d\Omega \\+
    &\sum_{s=1}^P\sum_{i=1}^Nu_{s,i}
      \left(\sum_{l=1}^d\sqrt{\lambda_l}
        \int_\Omega\int_{-1}^1\beta_l(x)\phi_i'(x)\phi_j'(x)
        \xi_l(\omega)\chi_s(\omega)\chi_t(\omega)\, dx\, d\Omega\right) \\
     &= \sum_{i=1}^Nf_i\int_\Omega\int_{-1}^1
      \phi_i(x)\phi_j(x)\chi_s(\omega)\chi_t(\omega)\, dx\, d\Omega
\end{align*}

for each $j \in \{1,\ldots,N\}$ and each $t \in \{1,\ldots,P\}$. Which defines
a $NP \times NP$ system of linear equations $A\v{u} = \v{f}$ in which the
matrix takes the following form:

\begin{equation}
    A = \left[\begin{array}{c c c}
            A_{1,1} & \cdots & A_{1,P} \\
            \vdots & & \vdots \\
            A_{P,1} & \cdots & A_{P,P}
        \end{array}\right]
\end{equation}

where each $A_{i,i}$ are $N \times N$ matrices

\section{Constructing the Global System}
